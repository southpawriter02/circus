#!/usr/bin/env bash

# ==============================================================================
#
# FILE:         info
#
# DESCRIPTION:  This command displays a summary of the system's hardware and
#               software configuration.
#
# ==============================================================================

# --- Initialization ---------------------------------------------------------
# Source the centralized initialization script to set up the environment.
source "$(dirname "${BASH_SOURCE[0]}")/../init.sh"

# --- Help and Usage ---------------------------------------------------------
usage() {
  msg_info "Usage: fc info"
  echo ""
  msg_info "Displays a summary of the system's configuration."
  echo ""
  exit 0
}

# --- Main Logic -------------------------------------------------------------
main() {
  if [ "$1" == "--help" ]; then
    usage
  fi

  msg_info "Gathering system information..."
  echo ""

  # --- Software Info ---
  msg_info "Software:"
  echo "  OS Version:   $(sw_vers -productName) $(sw_vers -productVersion) ($(sw_vers -buildVersion))"
  echo "  Hostname:     $(hostname)"
  echo "  Uptime:       $(uptime | awk -F, '{print $1}' | cut -d' ' -f 4-)"

  # --- Hardware Info ---
  echo ""
  msg_info "Hardware:"
  echo "  Model:        $(sysctl -n hw.model)"
  echo "  CPU:          $(sysctl -n machdep.cpu.brand_string)"
  
  # Get memory size in bytes and convert to GB
  local mem_bytes
  mem_bytes=$(sysctl -n hw.memsize)
  local mem_gb=$((mem_bytes / 1024 / 1024 / 1024))
  echo "  Memory:       ${mem_gb} GB"

  echo ""
  msg_success "System information gathering complete."
}

main "$@"
