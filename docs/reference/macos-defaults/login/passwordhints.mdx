# Login Window Password Hints

Control when password hints are displayed after failed attempts.

## Overview

| Property | Value |
|----------|-------|
| **Domain** | `com.apple.loginwindow` |
| **Key** | `RetriesUntilHint` |
| **Type** | Integer |
| **Default Value** | `3` |
| **Our Setting** | `0` |

## Description

Specifies the number of failed password attempts before displaying the user's password hint. Password hints can help users remember their passwords but also provide information to attackers. Setting to 0 completely disables password hints.

## Values

| Value | Behavior | Security |
|-------|----------|----------|
| `0` | Never show hints | Most secure |
| `1` | Show after 1 failed attempt | Least secure |
| `3` | Show after 3 attempts (default) | Moderate |
| `5` | Show after 5 attempts | More secure |
| `10` | Show after 10 attempts | Very secure |

## The Security Problem

Password hints often reveal too much:

| User's Password | Hint Set By User | Attacker Learns |
|-----------------|------------------|-----------------|
| `Fluffy2019!` | "My cat's name + year" | Pet name + year |
| `Steelers#1` | "Favorite team" | Likely pattern |
| `Summer2023` | "Season + year" | Exact format |

Many users create hints that essentially **give away** the password.

## Our Configuration

**Set to**: `0` — Never show hints.

### Why Disable Hints?

1. **Information disclosure** — Hints reveal patterns
2. **Social engineering** — Attackers use hints as clues
3. **Password managers** — Modern solution replaces hints
4. **Recovery options** — Apple ID recovery is safer
5. **Best practice** — Security frameworks recommend disabling

### When Hints Might Help

- Personal Mac with complex password
- No password manager available
- Infrequent logins (might forget)
- Family computer with simple needs

But even then, consider alternatives.

## Code Examples

```bash
# Read current value
defaults read com.apple.loginwindow RetriesUntilHint

# Disable password hints (recommended)
defaults write com.apple.loginwindow RetriesUntilHint -int 0

# Show after 3 failed attempts (default)
defaults write com.apple.loginwindow RetriesUntilHint -int 3

# Show after 5 failed attempts
defaults write com.apple.loginwindow RetriesUntilHint -int 5

# Delete (reset to default)
defaults delete com.apple.loginwindow RetriesUntilHint
```

## UI Location

**System Settings** → **Users & Groups** → **Login Options** (unlock required)

Setting: "Show password hints"

## Setting a Password Hint

When setting/changing password:
1. **System Settings** → **Users & Groups**
2. Select user → **Change Password**
3. Enter hint (or leave blank)

Existing hints remain until changed.

## Better Alternatives to Hints

| Alternative | How It Works |
|-------------|--------------|
| Apple ID Reset | Reset password via Apple ID |
| Recovery Key | FileVault recovery key |
| Password Manager | Secure storage for all passwords |
| Another Admin | Admin can reset other users |
| Recovery Mode | If you're the only admin |

## Apple ID Password Reset

More secure than hints:
1. Click **?** at login
2. Select "Reset it using your Apple ID"
3. Enter Apple ID credentials
4. Create new password

Requires Apple ID linked to user account.

## Removing Existing Hints

To clear a password hint:
1. Change password in Users & Groups
2. Leave hint field blank
3. Save

No command-line way to clear hints directly.

## Failed Attempt Counter

The counter that triggers hints:
- Resets after successful login
- Resets after timeout period
- Does not lock account (macOS doesn't lock by default)

## Enterprise Considerations

In managed environments:
- MDM can enforce hint policy
- May disable hints across organization
- Can set minimum password requirements

## Lockout Policies

macOS doesn't lock accounts after failed attempts by default. Consider:
- External lockout mechanisms
- Monitoring failed attempts
- FileVault (requires restart to retry infinitely)

## Related Settings

```bash
# Hide user list (more secure)
defaults write com.apple.loginwindow SHOWFULLNAME -bool true

# Disable guest account
defaults write com.apple.loginwindow GuestEnabled -bool false

# Disable automatic login
sudo defaults delete com.apple.loginwindow autoLoginUser
```

## Troubleshooting

| Issue | Solution |
|-------|----------|
| Hints still showing | Value might not be 0 |
| Can't change setting | Check for MDM profile |
| Forgot password, no hint | Use Apple ID reset |

## Compatibility

- **macOS**: All versions
- **Note**: May require logout to apply

## Source File

**File**: [`defaults/system/login.sh`](../../../defaults/system/login.sh)

```bash
run_defaults "com.apple.loginwindow" "RetriesUntilHint" "-int" "0"
```

## References

- [Apple Support: Reset login password](https://support.apple.com/en-us/102673)
- [Apple Support: Password hints](https://support.apple.com/guide/mac-help/password-hints-mh27124/mac)
